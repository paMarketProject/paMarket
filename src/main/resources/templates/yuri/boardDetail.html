<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"></script>
  <style>
    #kTitle{
        color: #00FF80;
        font-weight: bold;
        font-size: 20px;
    }
    #userImage{
        float: left;
    }
    #useruser{
        border: 1px solid #befadc;
        /*opacity:0.1;*/
        border-radius: 30px;
        height: 130px;
    }

    #footer {
        position: fixed;
        z-index: 1;
        background-color: green;
        left: 0;
        right: 0;
        bottom: 0;
        height: 5rem;
    }

    #price{
        color: white;
        font-size: 30px;
    }

    #heartImage{
        float: left;
    }

    #detailImg{
        width: 900px;
        text-align: center;
        margin: auto;
        display: block;
    }
    </style>
    <script>
        $(document).ready(function() {
            $("#edit").on("click", function() {
                const boardNum = $("#boardNum").val();
                const boardTitle = $("#boardTitle").val();
                const boardContents = $("#boardContents").val();

                $.ajax({
                    url:"/updateProductBoard",
                    type : "POST",
                    data : {boardNum : boardNum,
                            boardTitle : boardTitle,
                            boardContents : boardContents
                    },
                    success : function(data) {
                        alert("수정되었습니다")
                    },
                    error : function (){
                        alert("통신오류")
                    }
                })
            });
            $("#delete").on("click", function() {
                const boardNum = $("#boardNum").val();

                $.ajax({
                    url:"/deleteProductBoard",
                    type : "POST",
                    data : {boardNum : boardNum},
                    success : function(data) {
                        alert("삭제되었습니다")
                    },
                    error : function (){
                        alert("통신오류")
                    }
                })
            });
        })


    </script>


  <!--헤더-->
    <div th:fragment="header">
    <div th:insert="~{header.html::header}"></div>
    </div>
</head>

<body>
<div class="container">
    <form id="frm" method="post">
    <!--    글쓰기 부분-->
    <div class="row">
    <div class=" mx-auto">
      <div class="my-3 mt-4 p-4">
        <div class="row">
            <input type="hidden" id="boardNum" name="boardNum" th:value="${board.boardNum}">
                <img class="card-img-top" id="detailImg"  th:src="${board.filePath}" alt="..." />
<!--          </div>-->
            <br><br>
          <div id="useruser" class="mt-5">
        <img src="/YuriImage/user.png" alt="Logo" width="80" height="80" class="ms-5" id="userImage">
                <p align="right" class="me-5"> <img src="/YuriImage/tem2.png" width="80" height="80" style=""></p>
            <input type="text" class="form-control" id="user" name="user" placeholder="" th:value="|id : ${board.boardUserId}&emsp; ${board.locationName}&emsp; ${board.userManner}/5.0|"
                    style="border: none; background: transparent; font-size: 15px; color: #4d5154; font-weight: bold">
          </div>
          <br><br>

<!--          제목-->
        <div class="mt-4 p-2">
        <!--                    <label class="form-label" for="title" >글제목  </label>-->
                <input type="text" class="form-control" id="boardTitle" name="boardTitle" placeholder="제목" th:value="${board.boardTitle}"
                style="border: none; background: transparent; font-size: 40px; font-weight: bold">
            </div>

<!--          카테고리명-->
        <div class="p-2">
            <input type="text" class="form-control" id="kategory" name="kategory" placeholder="" th:value="|${board.kategoryName}&emsp; ${board.boardDate}|"
                    style="border: none; background: transparent; font-size: 15px; color: #4d5154">
        </div>
        <div class="mt-4 p-2">
        <!--                    <label class="form-label" for="contents">글내용 : </label>-->
           <textarea class="form-control" id="boardContents" name="boardContents" rows="20"
                    th:text="${board.boardContents}"  style="border: none; background: transparent;"></textarea>
      </div>
            <div class="mt-4 p-2">
<!--                <label class="form-label" for="hitCnt">조회수 :</label>-->
                <p class="form-control" id="hitCnt" name="hitCnt"
                            th:text="'조회수 : '+${board.boardHitCnt}"  style="border: none; background: transparent;"></p>
            </div>
        </div>
      </div>
    <div class="my-3">
        <hr>
        <p>지도넣는 위치</p>
        <div id="map" style="width:100%;height:550px;"></div>

        <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=bc9a41328d11782e12d6ff10ea00364d"></script>
        <script th:inline="javascript">
            /*<![CDATA[*/
            var mapX = /*[[ ${board.mapX} ]]*/;
            var mapY = /*[[ ${board.mapY} ]]*/;
            var mapContainer = document.getElementById('map'), // 지도를 표시할 div
                mapOption = {
                    center: new kakao.maps.LatLng(mapX, mapY), // 지도의 중심좌표
                    level: 3 // 지도의 확대 레벨
                };

            var map = new kakao.maps.Map(mapContainer, mapOption);


            // 마커가 표시될 위치입니다
            var markerPosition  = new kakao.maps.LatLng(mapX,mapY);

            // 마커를 생성합니다
            var marker = new kakao.maps.Marker({
                position: markerPosition
            });

            // 마커가 지도 위에 표시되도록 설정합니다
            marker.setMap(map);


            var iwContent = '<div style="padding:5px;">거래장소 <br><a href="kakaomap://route?sp=37.537229,127.005515&ep=37.4979502,127.0276368&by=PUBLICTRANSIT" style="color:blue" target="_blank">큰지도보기</a> <a href="https://map.kakao.com/link/to/Hello World!,33.450701,126.570667" style="color:blue" target="_blank">길찾기</a></div>', // 인포윈도우에 표출될 내용으로 HTML 문자열이나 document element가 가능합니다
                iwPosition = new kakao.maps.LatLng(mapX, mapY); //인포윈도우 표시 위치입니다

            // 인포윈도우를 생성합니다
            var infowindow = new kakao.maps.InfoWindow({
                position : iwPosition,
                content : iwContent
            });

            // 마커 위에 인포윈도우를 표시합니다. 두번째 파라미터인 marker를 넣어주지 않으면 지도 위에 표시됩니다
            infowindow.open(map, marker);
            /*]]>*/

        </script>
    </div>
    </div>

        <hr>
    </div>
        </div>
    </div>
            <div class="col-sm d-flex justify-content-end">
                <button type="button" class="btn btn-outline-warning me-2" id="edit">수정</button>
                <button type="button" class="btn btn-outline-danger" id="delete">삭제</button>
        </div>
    </form>
        <div class="container mt-5 p-5">
        <hr>
        </div>
        </div>

        <div id="footer">
            <div class="container">
            <div class="my-3 mt-4 ms-5">
                <img src="/YuriImage/heart.png" height="50px" id="heartImage">
                <div class="ms-5">
                    <div class="row justify-content-between">
                        <div class="col-4">
                            <p class="ms-4" th:text="${board.boardProPrice} + '원'" style="color: white; font-size: 30px"></p>
                        </div>
                        <div class="col-4">
                            <button class="btn btn-light" type="button">채팅하기</button>
                        </div>
<!--                <p class="ms-4" th:text="${board.boardProPrice} + '원'" style="color: white; font-size: 30px"></p>-->
<!--                <button class="btn btn-success" type="button">채팅하기</button>-->
                </div>
            </div>
            </div>
        </div>
</div>
</body>
</html>